---
title: 曲线调整
date: 2019-05-07 02:00:31
tags:
---

有一段代码是利用高斯函数来做曲线拟合的，比较简单和方便，调试起来可能也会简单些。

```C++

int LUTFromSTD_GS(int *LUT, int LUTSz = 3, int mean = 0, int sigma = 80, int weight = 50) {
    const int STD_LUT_SZ = 257;
    const int kSTDSigma = 70;
    const int PRCS = 10;
    static int STD_LUT[STD_LUT_SZ] = {};
    const int STD_LUT_Bit = 8;
    for (int i = 0; i < LUTSz; ++i) {
        int val = abs((i << 8) / SZ - mean);
        LUT[i] = weight * LUTInter(val, 10, STD_LUT, STD_LUT_SZ, STD_LUT_Bit)
    }
}


int LUTInter(int val, int valBit, int *LUT, int LUTSz, int LUTBit) {
    const int shift = valBit - LUTBit;
    const int index = val >> shift;
    if (index >= LUTSz - 1) { // index + 1>= LUTSz -> index + 1 <= LUTSz - 1
        return LUT[LUTSz - 1];
    } else {
        int ret = ((LUT[index + 1] - LUT[index]) * (val - (index << shift)) >> shift) + LUT[index]);
        return ret;
    }
}
```